<nz-form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm()" style="padding-bottom: 30px">
  <div nz-row class="row-title">
    <div nz-col [nzMd]="5">
      <span class="title">Tính giá bán một lần</span>
    </div>
  </div>
  <div nz-col [nzSpan]="8">
    <nz-form-item>
      <nz-form-label [nzSpan]="24" nzFor="TdcCustomerId" nzRequired>Khách Hàng</nz-form-label>
      <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa chọn tên khách hàng!">
        <nz-select
          formControlName="TdcCustomerId"
          name="TdcCustomerId"
          id="TdcCustomerId"
          [nzPlaceHolder]="'Chưa chọn tên khách hàng!'"
          [nzShowSearch]="true"
        >
          <nz-option *ngFor="let i of tdcCustomer_data; let idx = index" [nzLabel]="i.FullName" [nzValue]="i.Id"> </nz-option>
        </nz-select>
      </nz-form-control>
    </nz-form-item>
  </div>
  <div nz-row class="row-title">
    <div nz-col [nzMd]="5">
      <span class="title">Thông tin hợp đồng</span>
    </div>
  </div>
  <div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="8" *ngIf="add">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="Code" nzRequired>
          <span>Sô hợp đồng</span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24">
		<!-- //Qfix -->
          <!-- <nz-input-number class="width-100" nz-input formControlName="Code" [nzDisabled]="true"></nz-input-number> -->
          <nz-input-number class="width-100" nz-input formControlName="Code"></nz-input-number>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="8">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="Date" nzRequired>
          <span>Ngày kí hợp đồng</span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa nhập Ngày Kí Hợp Đồng">
          <input nz-input type="date" max="9999-12-31" formControlName="Date" />
        </nz-form-control>
      </nz-form-item>
    </div>
  </div>
  <div nz-row class="row-title">
    <div nz-col [nzMd]="5">
      <span class="title">Thông tin nhà</span>
    </div>
  </div>
  <div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="8">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="TdcProjectId" nzRequired>Dự án</nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa chọn dự án!">
          <nz-select
            formControlName="TdcProjectId"
            name="TdcProjectId"
            id="TdcProjectId"
            [nzPlaceHolder]="'Chưa chọn dự án!'"
            [nzShowSearch]="true"
            (ngModelChange)="[TDCLandByProject($event)]"
          >
            <nz-option *ngFor="let i of tdcProject_data; let idx = index" [nzLabel]="i.Name" [nzValue]="i.Id"> </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="8">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="LandId" nzRequired>Lô</nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa chọn lô!">
          <nz-select
            formControlName="LandId"
            name="LandId"
            id="LandId"
            [nzPlaceHolder]="'Chưa chọn lô!'"
            [nzShowSearch]="true"
            (ngModelChange)="[TDCBlockHouseByLand($event)]"
          >
            <nz-option *ngFor="let i of data_landTDC_filter; let idx = index" [nzLabel]="i.Name" [nzValue]="i.Id"> </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="8">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="BlockHouseId">Khối</nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa chọn lô!">
          <nz-select
            formControlName="BlockHouseId"
            name="BlockHouseId"
            id="BlockHouseId"
            [nzPlaceHolder]="'Chưa chọn khối!'"
            [nzShowSearch]="true"
            (ngModelChange)="[TDCFloorByBlockHouse($event)]"
          >
            <nz-option *ngFor="let i of data_BlockHouseTDC_filter; let idx = index" [nzLabel]="i.Name" [nzValue]="i.Id"> </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="8">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="FloorTdcId">Tầng</nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa chọn tầng!">
          <nz-select
            formControlName="FloorTdcId"
            name="FloorTdcId"
            id="FloorTdcId"
            [nzPlaceHolder]="'Chưa chọn tầng!'"
            [nzShowSearch]="true"
            (ngModelChange)="TDCApartmentrByFloor($event)"
          >
            <nz-option *ngFor="let i of data_FloorTDC_filter; let idx = index" [nzLabel]="i.Name" [nzValue]="i.Id"> </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="8">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="Floor1">Lầu</nz-form-label>
        <nz-form-control [nzSpan]="24">
          <nz-input-number formControlName="Floor1" class="width-100" nzDisabled="true"> </nz-input-number>
        </nz-form-control>
      </nz-form-item>
    </div>
    
    <div nz-col [nzSpan]="8" *ngIf="block_value && floor_value">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="TdcApartmentId" nzRequired>Căn</nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa chọn căn!">
          <nz-select (ngModelChange)="TdcCornerByApartment($event)" formControlName="TdcApartmentId"
            name="TdcApartmentId" id="TdcApartmentId" [nzPlaceHolder]="'Chưa Chọn Căn!'" [nzShowSearch]="true">
            <nz-option *ngFor="let i of data_ApartmentTDC_filter; let idx = index" [nzLabel]="i.Name" [nzValue]="i.Id">
            </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="8" *ngIf="!(block_value && floor_value)">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="PlatformId" nzRequired>Nền đất số</nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="hưa chọn nền đất số!">
          <nz-select formControlName="PlatformId" name="PlatformId" id="PlatformId"
            (ngModelChange)="TdcCornerByApartment($event)" [nzPlaceHolder]="'Chưa chọn nền đất số!'"
            [nzShowSearch]="true">
            <nz-option *ngFor="let i of data_PlatformTDC_filter; let idx = index" [nzLabel]="i.Name" [nzValue]="i.Id">
            </nz-option>
          </nz-select>
        </nz-form-control>
      </nz-form-item>
    </div>
    <nz-form-control [nzSpan]="24">
      <label nz-checkbox formControlName="Corner" name="Corner" id="Corner" nzDisabled="true" [(ngModel)]="check">
        <span>Lô góc</span>
      </label>
    </nz-form-control>
  </div>
  <div nz-row class="row-title">
    <div nz-col [nzMd]="7">
      <span class="title">Thông tin thành phần giá bán cấu thành(tạm thời)</span>
    </div>
  </div>
  <div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="DecisionNumberTT" >
          <span>Số QĐ </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback >
		<!-- //Qfix
		//<input nz-input type="DecisionNumberTT" formControlName="DecisionNumberTT" /> -->
          <input nz-input type="text" formControlName="DecisionNumberTT" />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="DecisionDateTT" nzRequired>
          <span>Ngày QĐ </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa nhập Ngày QĐ">
          <input nz-input type="date" max="9999-12-31" formControlName="DecisionDateTT" />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="TotalAreaTT">
          <span>Diện tích </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24">
          <input nz-input type="text" currencyMask  formControlName="TotalAreaTT" class="width-100" nzDisabled="true"/>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="TotalPriceTT">
          <span>Thành Tiền </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24">
          <input nz-input type="text" currencyMask formControlName="TotalPriceTT" class="width-100" nzDisabled="true"/>
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <app-tdc-price-one-sell-temporary
        #TdcPriceOneSellTemporaryComponent
        (eventEmitter)="ChangeTotalTemp($event)"
        [tdcPriceOneSellTemporaries]="validateForm.value.tdcPriceOneSellTemporaries"
      >
      </app-tdc-price-one-sell-temporary>
    </div>
  </div>
  <div nz-row class="row-title">
    <div nz-col [nzMd]="7">
      <span class="title">Thông tin thành phần giá bán cấu thành <span style="color: red"> (Chính thức)</span></span>
    </div>
  </div>
  <button nz-button [nzType]="'primary'" (click)="showLog()">Lịch sử thay đổi</button>
  <div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="DecisionNumberCT" nzRequired>
          <span>Số QĐ </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa nhập Số QĐ">
          <input nz-input type="DecisionNumberCT" formControlName="DecisionNumberCT" />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="DecisionDateCT" nzRequired>
          <span>Ngày QĐ </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24" nzHasFeedback nzErrorTip="Chưa nhập Ngày QĐ">
          <input nz-input type="date" max="9999-12-31" formControlName="DecisionDateCT" />
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="TotalAreaCT" nzRequired>
          <span>Diện Tích </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24">
          <input nz-input type="text" currencyMask  formControlName="TotalAreaCT" class="width-100" nzDisabled="true"/> 
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <nz-form-item>
        <nz-form-label [nzSpan]="24" nzFor="TotalPriceCT" nzRequired>
          <span>Thành Tiền </span>
        </nz-form-label>
        <nz-form-control [nzSpan]="24">
          <input nz-input type="text" currencyMask formControlName="TotalPriceCT" class="width-100" nzDisabled="true"/> 
        </nz-form-control>
      </nz-form-item>
    </div>
    <div nz-col [nzSpan]="24">
      <app-tdc-price-one-sell-official
        #TdcPriceOneSellOfficialComponent
        (eventEmitter)="ChangeTotalOffi($event)"
        [tdcPriceOneSellOfficials]="validateForm.value.tdcPriceOneSellOfficials"
      >
      </app-tdc-price-one-sell-official>
    </div>
  </div>

  <div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="12">
        <nz-form-item>
            <nz-form-label [nzSpan]="24" nzFor="PersonalTax" nzRequired>
                <span>Thuế TNCN</span>
            </nz-form-label>
            <nz-form-control [nzSpan]="24" >
                <input type="text" currencyMask [options]="{ precision: 2 }" nz-input formControlName="PersonalTax" currencyMask/>
            </nz-form-control>
        </nz-form-item>
    </div>
    <div nz-col [nzSpan]="12">
        <nz-form-item>
            <nz-form-label [nzSpan]="24" nzFor="RegistrationTax" nzRequired>
                <span>Thuế trước bạ</span>
            </nz-form-label>
            <nz-form-control [nzSpan]="24">
                <input type="text" currencyMask [options]="{ precision: 2 }" nz-input formControlName="RegistrationTax" currencyMask/>
            </nz-form-control>
        </nz-form-item>
    </div>      
      <div nz-col [nzSpan]="12">
          <nz-form-item>
              <nz-form-label [nzSpan]="24" nzFor="PaymentPublic" >
                  <span>Tiền nộp về công ích</span>
              </nz-form-label>
              <nz-form-control [nzSpan]="24" nzHasFeedback>
                  <input type="text" currencyMask [options]="{ precision: 2 }" nz-input formControlName="PaymentPublic" currencyMask/>
              </nz-form-control>
          </nz-form-item>
      </div>
  </div>
  <div nz-row class="row-title">
      <div nz-col [nzMd]="7">
        <span class="title">Thuế phí nông nghiệp</span>
      </div>
  </div>
  <div nz-row [nzGutter]="24">
      <div nz-col [nzSpan]="24">
        <app-tdc-price-one-sell-tax #TdcPriceOneSellTaxComponent [tdcPriceOneSellTaxes]="validateForm.value.tdcPriceOneSellTaxes">
        </app-tdc-price-one-sell-tax>
      </div>
  </div>    
</nz-form>
<div class="drawer-footer">
  <button nz-button [nzType]="'default'" (click)="close()">
    <i nz-icon nzType="stop" nzTheme="outline"></i>
    Đóng
  </button>
  <button nz-button [nzType]="'primary'" [disabled]="!validateForm.valid|| loading" (click)="submitForm()">
    <i nz-icon nzType="save" nzTheme="outline"></i>
    Lưu
  </button>
</div>
