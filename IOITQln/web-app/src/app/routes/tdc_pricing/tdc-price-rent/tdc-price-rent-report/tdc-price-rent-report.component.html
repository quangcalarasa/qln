<div style="overflow-x: auto">
  <ng-container *ngFor="let item of data; let index = index">
    <table class="table-bct">
      <thead>
        <tr>
          <th style="width: 30%" rowspan="2">STT </th>
          <th style="width: 30%" colspan="3">Chủ căn hộ</th>
          <th style="width: 40%" colspan="6">Thông tin căn hộ</th>

          <th colspan="3" *ngFor="let childItem of item.temporaryDatas">
            {{ childItem.Name }}
          </th>

          <th colspan="2">Giá bán(tạm thời) </th>
          <th [attr.colspan]="item.priceAndTaxTTs.length + 1" style="color: red"> Do not Show</th>
          <th colspan="3">Quyết định bố trí (tạm)</th>

          <th colspan="3" *ngFor="let childItem of item.officialDatas">
            {{ childItem.Name }}
          </th>

          <th colspan="2">Giá bán (Chính thức) </th>

          <th [attr.colspan]="item.priceAndTaxes.length + 1" style="color: red"> Do not Show(Chính Thức)</th>

          <th colspan="2">QĐ bố trí (chính thức)</th>
          <th colspan="2">Tiền Nộp Về </th>

          <ng-container *ngFor="let childItem of item.excels">
            <th rowSpan="2" style="background-color: yellowgreen"> Kỳ </th>
            <th rowSpan="2"> Ngày Phải nộp </th>
            <th rowSpan="2"> Ngày nộp tiền </th>
            <th rowSpan="2"> Số tiền phải nộp </th>
            <th rowSpan="2"> Lãi </th>
            <th rowSpan="2"> Phạt </th>
            <th rowSpan="2">Tiền gốc </th>
            <th rowSpan="2">VAT</th>
            <ng-container *ngFor="let childItem of item.priceAndTaxTTs">
              <th rowSpan="2" *ngIf="childItem.Name !== 'VAT'">{{ childItem.Name }}</th>
            </ng-container>
            <th rowSpan="2"> Nộp dư trong kỳ </th>
          </ng-container>
          <th [attr.colspan]="item.taxes.length * 2">Thuế phí nông nghiệp</th>
        </tr>
        <tr style="width: auto">
          <th rowspan="1">Số Hợp đồng </th>
          <th rowspan="1">Ngày ký hợp đồng </th>
          <th rowspan="1">Họ tên</th>
          <th rowspan="1">Căn hộ </th>
          <th rowspan="1">Lô góc </th>
          <th rowspan="1">khối</th>
          <th rowspan="1">Lô </th>
          <th rowspan="1">Tầng</th>
          <th rowspan="1">Lầu </th>

          <ng-container *ngFor="let childItem of item.temporaryDatas">
            <th rowspan="1" rowspan="1"> Diện tích </th>
            <th rowspan="1" rowspan="1"> Đơn Giá </th>
            <th rowspan="1" rowspan="1"> Thành Tiền </th>
          </ng-container>

          <th rowspan="1">Diện tích </th>
          <th rowspan="1">Thành tiền</th>

          <th rowspan="1">% gốc</th>
          <ng-container *ngFor="let childItem of item.priceAndTaxTTs">
            <th rowspan="1">{{ childItem.Name }}</th>
          </ng-container>

          <th rowspan="1">Số quyết định </th>
          <th rowspan="1">Ngày quyết định </th>
          <th rowspan="1">Thanh toán lần đầu </th>

          <ng-container *ngFor="let childItem of item.officialDatas">
            <th rowspan="1"> Diện tích </th>
            <th rowspan="1"> Đơn Giá </th>
            <th rowspan="1"> Thành Tiền </th>
          </ng-container>

          <th rowspan="1">Diện tích </th>
          <th rowspan="1">Thành tiền</th>

          <th rowspan="1">% gốc</th>
          <ng-container *ngFor="let childItem of item.priceAndTaxes">
            <th rowspan="1">{{ childItem.Name }} </th>
          </ng-container>

          <th rowspan="1">Số QĐ </th>
          <th rowspan="1">Ngày QĐ</th>

          <th rowspan="1">Tiền nộp về Trung Tâm</th>
          <th rowspan="1">Tiền nộp về công ích </th>

          <ng-container *ngFor="let childItem of item.taxes">
            <th rowspan="1" style="background-color: yellowgreen">Năm</th>
            <th rowspan="1">Số tiền</th>
          </ng-container>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text-center">{{ index + 1 }}</td>
          <td class="text-center">{{ item.Code }}</td>
          <td class="text-center">{{ item.ContractDate | date: 'dd/MM/yyyy' }}</td>
          <td class="text-center">{{ item.CustomerName }}</td>
          <td class="text-center">{{ item.ApartmentName }}</td>
          <td class="text-center"> <input type="checkbox" [checked]="item.Corner" disabled /></td>
          <td class="text-center">{{ item.BlockHouseName }}</td>
          <td class="text-center">{{ item.LandName }}</td>
          <td class="text-center">{{ item.FloorName }}</td>
          <td class="text-center">{{ item.Floor }}</td>

          <ng-container *ngFor="let childItem of item.temporaryDatas">
            <td class="text-center">{{ childItem.Area }}</td>
            <td class="text-center">{{ childItem.UnitPrice | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.Price | number: '0.0-2':'de-DE'}}</td>
          </ng-container>

          <td class="text-center">{{ item.TotalAreaTT | number: '0.0-2':'de-DE'}}</td>
          <td class="text-center">{{ item.TotalPirceTT | number: '0.0-2':'de-DE'}}</td>
          <td class="text-center"> {{ item.PercentOriginTT | number: '0.0-2':'de-DE'}} %</td>
          <ng-container *ngFor="let childItem of item.priceAndTaxTTs">
            <td class="text-center">{{ childItem.Total | number: '0.0-2':'de-DE'}} %</td>
          </ng-container>

          <td class="text-center">{{ item.DecisionNumberTT }}</td>
          <td class="text-center">{{ item.DecisionDateTT | date: 'dd/MM/yyyy' }}</td>
          <td class="text-center">{{ item.FistPayment | date: 'dd/MM/yyyy' }}</td>

          <ng-container *ngFor="let childItem of item.officialDatas">
            <td class="text-center">{{ childItem.Area }}</td>
            <td class="text-center">{{ childItem.UnitPrice | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.Price | number: '0.0-2':'de-DE'}}</td>
          </ng-container>

          <td class="text-center">{{ item.TotalAreaCT | number: '0.0-2':'de-DE'}}</td>
          <td class="text-center">{{ item.TotalPirceCT | number: '0.0-2':'de-DE'}}</td>

          <td class="text-center"> {{ item.PercentOriginCT | number: '0.0-2':'de-DE'}} %</td>
          <ng-container *ngFor="let childItem of item.priceAndTaxes">
            <td class="text-center">{{ childItem.Total | number: '0.0-2':'de-DE'}} %</td>
          </ng-container>

          <td class="text-center">{{ item.DecisionNumberCT }}</td>
          <td class="text-center">{{ item.DecisionDateCT | date: 'dd/MM/yyyy' }}</td>
          <td></td>
          <td></td>
          <ng-container *ngFor="let childItem of item.excels">
            <th> Kỳ {{ childItem.index }}</th>
            <td class="text-center">{{ childItem.PaymentDate | date: 'dd/MM/yyyy' }}</td>
            <td class="text-center">{{ childItem.PayDate | date: 'dd/MM/yyyy' }}</td>
            <td class="text-center">{{ childItem.AmountPayable | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.Interest | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.PricePunish | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.PrinCipal | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.VAT | number: '0.0-2':'de-DE'}}</td>
            <ng-container *ngFor="let childItem1 of childItem.excelChilds">
              <td *ngIf="childItem1.Name !== 'VAT'" class="text-center">{{ childItem1.TotalValue | number:
                '0.0-2':'de-DE'}}</td>
            </ng-container>
            <td class="text-center">{{ childItem.Overpayment | number: '0.0-2':'de-DE'}}</td>
          </ng-container>
          <ng-container *ngFor="let childItem1 of item.taxes">
            <td class="text-center">{{ childItem1.Year }}</td>
            <td class="text-center">{{ childItem1.Price | number: '0.0-2':'de-DE'}}</td>
          </ng-container>
        </tr>
      </tbody>
    </table>
  </ng-container>
</div>
<div>
  <!-- <button nz-button nzType="primary" nz-button (click)="btn()">
    <i nz-icon nzType="cloud" nzTheme="outline"></i>
    Xem dữ liệu
  </button> -->
  <button nz-button nzType="primary" nz-button (click)="exportReport()" style="margin: 20px">
    <i nz-icon nzType="download" nzTheme="outline"></i>
    Xuất file excel
  </button>
</div>