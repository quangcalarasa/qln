<div style="overflow-x: auto">
  <ng-container *ngFor="let item of data; let index = index">
    <table class="table-bct" style="width: auto">
      <thead>
        <tr>
          <th rowspan="2">STT </th>
          <th colspan="3">Chủ căn hộ</th>
          <th colspan="6">Thông tin căn hộ</th>

          <th colspan="3" *ngFor="let childItem of item.reportIngreTemporarys">
            {{ childItem.IngrePriceName }}
          </th>

          <th colspan="2">Giá bán(tạm thời) </th>
          <th [attr.colspan]="item.reportPatTemporarys.length + 1" style="color: red"> Do not Show</th>
          <th colspan="3">Quyết định bố trí (tạm)</th>

          <th colspan="3" *ngFor="let childItem of item.reportIngres">
            {{ childItem.IngrePriceName }}
          </th>

          <th colspan="2">Giá bán (Chính thức) </th>

          <th [attr.colspan]="item.reportPats.length + 1" style="color: red"> Do not Show(Chính Thức)</th>

          <th colspan="2">QĐ bố trí (chính thức)</th>
          <th colspan="2">Tiền Nộp Về </th>
          <ng-container *ngFor="let childItem of item.payDetails">
            <th rowSpan="2" style="background-color: yellowgreen"> Kỳ </th>
            <th rowSpan="2"> Ngày Phải nộp </th>
            <th rowSpan="2"> Ngày nộp tiền </th>
            <th rowSpan="2"> Số tiền phải nộp </th>
            <th rowSpan="2"> Lãi </th>
            <th rowSpan="2"> Phạt </th>
            <th rowSpan="2">Tiền gốc </th>
            <ng-container *ngFor="let childItem of item.reportPats">
              <th rowSpan="2" *ngIf="childItem.Name !== 'VAT'">{{ childItem.PATName }}</th>
            </ng-container>
            <th rowSpan="2"> Nộp dư trong kỳ </th>
          </ng-container>
          <th [attr.colspan]="item.taxes.length * 2">Thuế phí nông nghiệp</th>
        </tr>
        <tr>
          <th rowspan="1">Số Hợp đồng </th>
          <th rowspan="1">Ngày ký hợp đồng </th>
          <th rowspan="1">Họ tên</th>
          <th rowspan="1">Căn hộ </th>
          <th rowspan="1">Lô góc </th>
          <th rowspan="1">khối</th>
          <th rowspan="1">Lô </th>
          <th rowspan="1">Lầu </th>
          <th rowspan="1">Tầng</th>

          <ng-container *ngFor="let childItem of item.reportIngreTemporarys">
            <th rowspan="1" rowspan="1"> Diện tích </th>
            <th rowspan="1" rowspan="1"> Đơn Giá </th>
            <th rowspan="1" rowspan="1"> Thành Tiền </th>
          </ng-container>

          <th rowspan="1">Diện tích </th>
          <th rowspan="1">Thành tiền</th>

          <th rowspan="1">% gốc</th>

          <ng-container *ngFor="let childItem of item.reportPatTemporarys">
            <th rowspan="1">{{ childItem.PATName }}</th>
          </ng-container>

          <th rowspan="1">Số quyết định </th>
          <th rowspan="1">Ngày quyết định </th>
          <th rowspan="1">Thanh toán lần đầu </th>

          <ng-container *ngFor="let childItem of item.reportIngres">
            <th rowspan="1"> Diện tích </th>
            <th rowspan="1"> Đơn Giá </th>
            <th rowspan="1"> Thành Tiền </th>
          </ng-container>

          <th rowspan="1">Diện tích </th>
          <th rowspan="1">Thành tiền</th>

          <th rowspan="1">% gốc</th>
          <ng-container *ngFor="let childItem of item.reportPats">
            <th rowspan="1">{{ childItem.PATName }} </th>
          </ng-container>

          <th rowspan="1">Số QĐ </th>
          <th rowspan="1">Ngày QĐ</th>

          <th rowspan="1">Tiền nộp về Trung Tâm</th>
          <th rowspan="1">Tiền nộp về công ích </th>
          <ng-container *ngFor="let childItem of item.taxes">
            <th rowspan="1" style="background-color: yellowgreen">Năm</th>
            <th rowspan="1">Số tiền</th>
          </ng-container>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="text-center">{{ index + 1 }}</td>
          <td class="text-center">{{ item.ContractNumber }}</td>
          <td class="text-center">{{ item.DateNumber | date: 'dd/MM/yyyy' }}</td>
          <td class="text-center">{{ item.CustomerName }}</td>
          <td class="text-center">{{ item.TdcApartmentName }}</td>
          <td class="text-center"> <input type="checkbox" [checked]="item.Corner" disabled /></td>
          <td class="text-center">{{ item.TdcBlockHouseName }}</td>
          <td class="text-center">{{ item.TdcLandName }}</td>
          <td class="text-center">{{ item.TdcFloorName }}</td>
          <td class="text-center">{{ item.Floor1 }}</td>

          <ng-container *ngFor="let childItem of item.reportIngreTemporarys">
            <td class="text-center">{{ childItem.Area }}</td>
            <td class="text-center">{{ childItem.UnitPrice | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.Price | number: '0.0-2':'de-DE'}}</td>
          </ng-container>

          <td class="text-center">{{ item.TemporaryTotalArea | number: '0.0-2':'de-DE'}}</td>
          <td class="text-center">{{ item.TemporaryTotalPrice | number: '0.0-2':'de-DE'}}</td>

          <td class="text-center"> {{ item.OriginalPrecentTemprorary }} %</td>

          <ng-container *ngFor="let childItem of item.reportPatTemporarys">
            <td class="text-center">{{ childItem.Percent }} %</td>
          </ng-container>

          <td class="text-center">{{ item.TemporaryDecreeNumber }}</td>
          <td class="text-center">{{ item.TemporaryDecreeDate | date: 'dd/MM/yyyy' }}</td>
          <td class="text-center">{{ item.FirstPayDate | date: 'dd/MM/yyyy' }}</td>

          <ng-container *ngFor="let childItem of item.reportIngres">
            <td class="text-center">{{ childItem.Area }}</td>
            <td class="text-center">{{ childItem.UnitPrice | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.Price | number: '0.0-2':'de-DE'}}</td>
          </ng-container>

          <td class="text-center">{{ item.TotalArea | number: '0.0-2':'de-DE'}}</td>
          <td class="text-center">{{ item.TotalPrice | number: '0.0-2':'de-DE'}}</td>

          <td class="text-center"> {{ item.OriginalPrecent }} %</td>

          <ng-container *ngFor="let childItem of item.reportPats">
            <td class="text-center">{{ childItem.Percent }} %</td>
          </ng-container>

          <td class="text-center">{{ item.DecreeNumber }}</td>
          <td class="text-center">{{ item.DecreeDate | date: 'dd/MM/yyyy' }}</td>
          <td></td>
          <td></td>
          <ng-container *ngFor="let childItem of item.payDetails">
            <th> Kỳ {{ childItem.index }}</th>
            <td class="text-center">{{ childItem.PayDateDefault | date: 'dd/MM/yyyy' }}</td>
            <td class="text-center">{{ childItem.PayDateReal | date: 'dd/MM/yyyy' }}</td>
            <td class="text-center">{{ childItem.PayAnnual | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.TotalInterest | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.Fines | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.PrinCipal | number: '0.0-2':'de-DE'}}</td>
            <td class="text-center">{{ childItem.VAT | number: '0.0-2':'de-DE'}}</td>
            <ng-container *ngFor="let childItem1 of childItem.payDetailChilds">
              <td *ngIf="childItem1.Name !== 'VAT'" class="text-center">{{ childItem1.TotalValue | number:
                '0.0-2':'de-DE'}}</td>
            </ng-container>
            <td class="text-center">{{ childItem.OverPay | number: '0.0-2':'de-DE'}}</td>
          </ng-container>
          <ng-container *ngFor="let childItem1 of item.taxes">
            <td class="text-center">{{ childItem1.Year }}</td>
            <td class="text-center">{{ childItem1.Price | number: '0.0-2':'de-DE'}}</td>
          </ng-container>
        </tr>
      </tbody>
    </table>
  </ng-container>
</div>
<button nz-button nzType="primary" nz-button (click)="exportReport()" style="margin: 20px">
  <i nz-icon nzType="download" nzTheme="outline"></i>
  Xuất file excel
</button>