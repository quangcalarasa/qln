<div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="8">
        <nz-form-item>
            <nz-form-label [nzSpan]="24">Danh sách đề xuất</nz-form-label>
        </nz-form-item>
    </div>
</div>
<div nz-row>
    <div nz-span>
        <a nz-button nzType="link" (click)="addRow()">
            <span nz-icon nzType="plus-circle"></span>
            Thêm mới
        </a>
    </div>
</div>
<div nz-row [nzGutter]="24">
    <div nz-col [nzSpan]="24">
        <div class="card-body">
            <st #tableItemRef [data]="data" (change)="tableItemRefChange($event)" [columns]="columnsItem"
                [size]="'small'" [loading]="loading" [widthMode]="{ type: 'strict' }" [page]="{ front: false }">
                <ng-template st-row="DateHeader" type="title"><span class="danger-star">*</span>&nbsp;Ngày đề xuất
                </ng-template>
                <ng-template st-row="AuthLetterHeader" type="title"><span class="danger-star"></span>&nbsp;File đính kèm
                </ng-template>
                <ng-template st-row="ProposeOptionHeader" type="title"><span class="danger-star">*</span>&nbsp;Phương án
                    đề xuất<span class="danger-star">*</span>
                </ng-template>
                <ng-template st-row="BrowseStatusHeader" type="title"><span class="danger-star">*</span>&nbsp;Ý kiến
                    duyệt<span class="danger-star">*</span>
                </ng-template>
                <ng-template st-row="BrowseDateHeader" type="title"><span class="danger-star">*</span>&nbsp;Ngày
                    duyệt<span class="danger-star">*</span>
                </ng-template>
                <ng-template st-row="NoteHeader" type="title">Ghi chú<span class="danger-star">*</span>
                </ng-template>
                <!-- <ng-template st-row="IngredientsPriceId" let-item let-index="index" nzWidth="500px">
                    <nz-select *ngIf="item.edit" nzAllowClear name="IngrePriceName" id="IngrePriceName" nzPlaceHolder=""
                        class="width-40" [ngModel]="item.IngredientsPriceId" [nzDropdownMatchSelectWidth]=false
                        (ngModelChange)="onSelect(index,$event)" [ngModelOptions]="{ standalone: true }"
                        [ngClass]="item.submit && !item.IngredientsPriceId ? 'danger-st-row' : ''">
                        <nz-option *ngFor="let i of ingre_price_data; let idx = index" [nzLabel]="i.Name"
                            [nzValue]="i.Id" [nzDisabled]="i.disabled">
                        </nz-option>
                    </nz-select>
                    <ng-container *ngIf="!item.edit">{{ item.IngrePriceName }}</ng-container>
                </ng-template> -->
                <ng-template st-row="Date" let-item let-index="index">
                    <input nz-input *ngIf="item.edit" [ngModel]="item.Date" type="date" max="9999-12-31"
                        [ngClass]="item.submit && !item.Date ? 'danger-st-row' : ''"
                        (ngModelChange)="tableItemRef.setRow(index, { Date: $event })"
                        [ngModelOptions]="{ standalone: true }" />
                    <ng-container *ngIf="!item.edit">{{ item.Date | date: 'dd/MM/yyyy'}}</ng-container>
                </ng-template>
                <ng-template st-row="AuthLetter" let-item let-index="index">
                    <nz-upload *ngIf="item.edit" nzName="AuthLetter" [nzShowUploadList]="false"
                        [nzBeforeUpload]="beforeUpload" (click)="idxRow=index">
                        <button nz-button type="button">
                            <span nz-icon nzType="upload"></span>
                            Tải file đính kèm
                        </button>
                    </nz-upload>
                    <ng-container>&nbsp;&nbsp;&nbsp;
                        <span class="text-truncate width-md d-inline-block" style="vertical-align: middle;">
                            <a *ngIf="item.AuthLetter" href="javascript:void(0)" (click)="downloadFile(item.AuthLetter)">{{
                                item.AuthLetter }}</a>
                        </span>
                    </ng-container>
                </ng-template>
                <ng-template st-row="ProposeOption" let-item let-index="index">
                    <input nz-input type="text" *ngIf="item.edit" [ngModel]="item.ProposeOption"
                        [ngClass]="item.submit && !item.ProposeOption ? 'danger-st-row' : ''"
                        (ngModelChange)="tableItemRef.setRow(index, { ProposeOption: $event })"
                        [ngModelOptions]="{ standalone: true }" />
                    <ng-container *ngIf="!item.edit">{{ item.ProposeOption }}</ng-container>
                </ng-template>
                <ng-template st-row="BrowseStatus" let-item let-index="index">
                    <input nz-input type="text" *ngIf="item.edit" [ngModel]="item.BrowseStatus"
                        [ngClass]="item.submit && !item.BrowseStatus ? 'danger-st-row' : ''"
                        (ngModelChange)="tableItemRef.setRow(index, { BrowseStatus: $event })"
                        [ngModelOptions]="{ standalone: true }" />
                    <ng-container *ngIf="!item.edit">{{ item.BrowseStatus }}</ng-container>
                </ng-template>
                <ng-template st-row="BrowseDate" let-item let-index="index">
                    <input nz-input *ngIf="item.edit" [ngModel]="item.BrowseDate" type="date" max="9999-12-31"
                        [ngClass]="item.submit && !item.BrowseDate ? 'danger-st-row' : ''"
                        (ngModelChange)="tableItemRef.setRow(index, { BrowseDate: $event })"
                        [ngModelOptions]="{ standalone: true }" />
                    <ng-container *ngIf="!item.edit">{{ item.BrowseDate | date: 'dd/MM/yyyy'}}</ng-container>
                </ng-template>
                <ng-template st-row="Note" let-item let-index="index">
                    <input nz-input type="text" *ngIf="item.edit" [ngModel]="item.Note"
                        [ngClass]="item.submit && !item.Note ? 'danger-st-row' : ''"
                        (ngModelChange)="tableItemRef.setRow(index, { Note: $event })"
                        [ngModelOptions]="{ standalone: true }" />
                    <ng-container *ngIf="!item.edit">{{ item.Note }}</ng-container>
                </ng-template>
            </st>
        </div>
    </div>
</div>